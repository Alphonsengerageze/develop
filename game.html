<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Professional Spinning Wheel Game</title>
<style>
  body {
    font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
    background: #f0f4f8;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: start;
    min-height: 100vh;
    margin: 0;
  }

  h2 {
    margin-top: 30px;
    font-size: 24px;
    color: #333;
    text-align: center;
  }

  /* Wheel container styles */
  #wheelContainer {
    position: relative;
    margin-top: 30px;
    width: 400px;
    height: 400px;
  }

  #wheel {
    width: 400px;
    height: 400px;
    border-radius: 50%;
    border: 8px solid #444;
    background: conic-gradient(
      hsl(0, 70%, 50%) 0deg 60deg,
      hsl(60, 70%, 50%) 60deg 120deg,
      hsl(120, 70%, 50%) 120deg 180deg,
      hsl(180, 70%, 50%) 180deg 240deg,
      hsl(240, 70%, 50%) 240deg 300deg,
      hsl(300, 70%, 50%) 300deg 360deg
    );
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
    margin: 0 auto;
    position: relative;
  }

  #pointer {
    position: absolute;
    top: -40px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; height: 0;
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 40px solid #d33;
    z-index: 10;
  }

  /* Controls container styling */
  #controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 40px;
    width: 90%;
    max-width: 500px;
    padding: 20px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }

  /* Money input section styling */
  #moneySection {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }

  #moneySection input[type="number"] {
    padding: 8px 12px;
    font-size: 16px;
    border-radius: 8px;
    border: 2px solid #ccc;
    width: 130px;
  }

  #moneySection button {
    background: #007bff;
    color: #fff;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s;
  }

  #moneySection button:hover {
    background: #0069d9;
  }

  /* Spin button styling */
  #spinBtn {
    background: #28a745;
    color: #fff;
    border: none;
    padding: 12px 24px;
    font-size: 18px;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 10px;
    transition: background 0.3s;
  }

  #spinBtn:hover:enabled {
    background: #218838;
  }

  #spinBtn:disabled {
    background: #ccc;
    cursor: not-allowed;
  }

  /* Balance and inserted money display styles */
  #balanceContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 30px;
    justify-content: center;
    width: 100%;
  }

  .balanceBox {
    background: #fff;
    padding: 15px 20px;
    border-radius: 15px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    min-width: 200px;
    text-align: center;
    font-size: 20px;
    font-weight: 600;
    color: #444;
  }

  /* Result message styling */
  #result {
    margin-top: 30px;
    min-height: 60px;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
  }

  /* Animate number change for balance display */
  #balanceDisplay span {
    display: inline-block;
    min-width: 100px;
    text-align: center;
  }

  @keyframes blink {
    0%, 100% { background-color: transparent; }
    50% { background-color: #ffff99; }
  }

  /* Blink effect for feedback */
  .blink {
    animation: blink 0.5s ease-in-out;
  }
</style>
</head>
<body>

<h2>üé° Professional Spinning Wheel Game üé°</h2>

<!-- Wheel -->
<div id="wheelContainer">
  <div id="pointer"></div>
  <div id="wheel"></div>
</div>

<!-- Controls -->
<div id="controls">
  <!-- Insert money -->
  <div id="moneySection">
    <input type="number" id="amountInput" min="0.01" step="0.01" placeholder="Insert amount" />
    <button id="insertBtn">Insert Money</button>
  </div>

  <!-- Select option -->
  <div style="margin-bottom: 15px;">
    <label for="optionSelect" style="font-weight: 600;">Choose your option:</label>
    <select id="optionSelect" style="margin-left: 10px; padding: 8px; border-radius: 8px; border: 2px solid #ccc; font-size: 16px;">
      <!-- options populated by JS -->
    </select>
  </div>

  <!-- Spin button -->
  <button id="spinBtn" disabled>Spin</button>

  <!-- Balances -->
  <div id="balanceContainer">
    <div class="balanceBox" id="totalBalanceBox">
      Total Balance<br>
      <span id="totalBalance">$0.00</span>
    </div>
    <div class="balanceBox" id="insertedBalanceBox">
      Inserted Money<br>
      <span id="insertedBalance">$0.00</span>
    </div>
  </div>

  <!-- Result message -->
  <div id="result"></div>
</div>

<script>
  // Options
  const options = ["Option 1", "Option 2", "Option 3", "Option 4", "Option 5", "Option 6"];

  const wheel = document.getElementById('wheel');
  const resultDiv = document.getElementById('result');
  const spinBtn = document.getElementById('spinBtn');
  const optionSelect = document.getElementById('optionSelect');
  const totalBalanceSpan = document.getElementById('totalBalance');
  const insertedBalanceSpan = document.getElementById('insertedBalance');
  const amountInput = document.getElementById('amountInput');
  const insertBtn = document.getElementById('insertBtn');

  let totalBalance = 0;
  let insertedMoney = 0;
  let lastInsertedAmount = 0;
  let isSpinning = false;
  const spinDuration = 4000;

  // Populate options
  options.forEach(opt => {
    const optElem = document.createElement('option');
    optElem.value = opt;
    optElem.textContent = opt;
    optionSelect.appendChild(optElem);
  });

  // Update display functions
  function updateTotalBalance() {
    totalBalanceSpan.innerHTML = `$${totalBalance.toFixed(2)}`;
    // Enable spin if enough balance
    spinBtn.disabled = isSpinning || totalBalance < 1;
  }

  function updateInsertedBalance() {
    document.getElementById('insertedBalance').innerHTML = `$${insertedMoney.toFixed(2)}`;
  }

  // Animate balance update
  function animateBalance(element, newVal) {
    const current = parseFloat(element.textContent.replace('$',''));
    const steps = 30;
    let count = 0;
    const delta = (newVal - current) / steps;
    const interval = setInterval(() => {
      count++;
      const val = current + delta * count;
      element.innerHTML = `$${val.toFixed(2)}`;
      if (count >= steps) {
        clearInterval(interval);
        element.innerHTML = `$${newVal.toFixed(2)}`;
      }
    }, 20);
  }

  // Insert money handler
document.getElementById('insertBtn').addEventListener('click', () => {
  const amount = parseFloat(amountInput.value);
  if (isNaN(amount) || amount <= 0) {
    resultDiv.innerHTML = `<span style="color:red;">Please enter a valid amount.</span>`;
    return;
  }
  lastInsertedAmount = Math.round(amount * 100) / 100;
  totalBalance = Math.round((totalBalance + lastInsertedAmount) * 100) / 100;
  insertedMoney = Math.round((insertedMoney + lastInsertedAmount) * 100) / 100;
  updateTotalBalance();
  updateInsertedBalance();
  resultDiv.innerHTML = `Inserted $${lastInsertedAmount.toFixed(2)}.`;
});

// Web Audio API for sounds
const ctx = new (window.AudioContext || window.webkitAudioContext)();

function playSpinSound() {
  const bufferSize = ctx.sampleRate * 0.5;
  const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
  const data = buffer.getChannelData(0);
  for (let i = 0; i < bufferSize; i++) data[i] = (Math.random() * 2 - 1) * (1 - i / bufferSize);
  const source = ctx.createBufferSource();
  source.buffer = buffer;
  const filter = ctx.createBiquadFilter();
  filter.type = 'lowpass';
  filter.frequency.setValueAtTime(2000, ctx.currentTime);
  source.connect(filter);
  const gainNode = ctx.createGain();
  gainNode.gain.setValueAtTime(0.001, ctx.currentTime);
  gainNode.gain.linearRampToValueAtTime(0.25, ctx.currentTime + 0.02);
  gainNode.gain.linearRampToValueAtTime(0.001, ctx.currentTime + 0.5);
  filter.connect(gainNode).connect(ctx.destination);
  source.start();
  source.stop(ctx.currentTime + 0.5);
}

function playOutcomeSound(win) {
  const osc = ctx.createOscillator();
  const gainNode = ctx.createGain();
  osc.type = 'sine';
  osc.frequency.value = win ? 880 : 220;
  gainNode.gain.setValueAtTime(0, ctx.currentTime);
  gainNode.gain.linearRampToValueAtTime(0.15, ctx.currentTime + 0.02);
  gainNode.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.8);
  osc.connect(gainNode).connect(ctx.destination);
  osc.start();
  osc.stop(ctx.currentTime + 0.9);
}

// Spin button logic
document.getElementById('spinBtn').addEventListener('click', () => {
  if (isSpinning) return;
  if (totalBalance < 1) {
    resultDiv.innerHTML = `<span style="color:red;">Insufficient funds! Please insert money.</span>`;
    return;
  }

  // Deduct cost
  totalBalance = Math.round((totalBalance - 1) * 100) / 100;
  updateTotalBalance();

  isSpinning = true;
  resultDiv.innerHTML = `Spinning...`;

  const numOptions = options.length;
  const anglePerOption = 360 / numOptions;
  const randomIndex = Math.floor(Math.random() * numOptions);
  const targetOption = options[randomIndex];

  const spins = 8;
  const targetAngle = randomIndex * anglePerOption + anglePerOption / 2;
  const stopAngle = spins * 360 + (360 - targetAngle);

  playSpinSound();

  wheel.style.transition = `transform ${spinDuration}ms cubic-bezier(0.33,1,0.68,1)`;
  requestAnimationFrame(() => {
    wheel.style.transform = `rotate(${stopAngle}deg)`;
  });

  setTimeout(() => {
    const normalized = stopAngle % 360;
    const selectedIndex = Math.floor((360 - normalized) / anglePerOption) % numOptions;
    const selectedOption = options[(selectedIndex + numOptions) % numOptions];

    const userChoice = document.getElementById('optionSelect').value;
    const isWin = userChoice === selectedOption;

    if (isWin) {
      // Double inserted money
      totalBalance = Math.round((totalBalance + insertedMoney) * 2 * 100) / 100;
      resultDiv.innerHTML = `<span style="color:green;">üéâ You chose ${userChoice} and the wheel landed on ${selectedOption}.<br>Money doubled!</span>`;
    } else {
      // Lose inserted money
      if (totalBalance >= insertedMoney) {
        totalBalance = Math.round((totalBalance - insertedMoney) * 100) / 100;
      } else {
        totalBalance = 0;
      }
      resultDiv.innerHTML = `<span style="color:red;">üôÅ You chose ${userChoice} but landed on ${selectedOption}.<br>You lost the inserted money.</span>`;
    }
    animateBalance(updateDisplay=updateTotalBalance, newVal=totalBalance);
    updateTotalBalance();
    updateInsertedBalance();
    playOutcomeSound(isWin);
    isSpinning = false;
  }, spinDuration + 50);
});

// Animate balance change
function animateBalance(updateDisplay, newVal) {
  const current = parseFloat(document.getElementById('totalBalance').textContent.replace('$',''));
  const steps = 30;
  let count = 0;
  const delta = (newVal - current) / steps;
  const interval = setInterval(() => {
    count++;
    const val = current + delta * count;
    document.getElementById('totalBalance').innerHTML = `$${val.toFixed(2)}`;
    if (count >= steps) {
      clearInterval(interval);
      document.getElementById('totalBalance').innerHTML = `$${newVal.toFixed(2)}`;
    }
  }, 20);
}

// Initialize display
updateTotalBalance();
updateInsertedBalance();
</script>
</body>
</html>